(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     98444,       2515]
NotebookOptionsPosition[     97062,       2475]
NotebookOutlinePosition[     97417,       2491]
CellTagsIndexPosition[     97374,       2488]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Copy of everything from treeDecomposition.m", "Text",
 CellChangeTimes->{{3.720031126646573*^9, 
  3.7200311364279203`*^9}},ExpressionUUID->"2aaadf99-5258-4061-a67b-\
04c38125bd57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Bulatov`common`\>\"", "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "map", " ", "vertices", " ", "to", " ", "indices", " ", "in", " ", 
    "adjacency", " ", "matrix", " ", "and", " ", "back"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Needs", " ", "global", " ", "V"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"initialized", " ", "as", " ", "V"}], "=", 
      RowBox[{"VertexList", "[", "g", "]"}]}], ";"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vert2idx", "[", "verts_List", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"V", ",", 
      RowBox[{"Alternatives", "@@", "verts"}]}], "]"}], "]"}]}], ";"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"idx2vert", "[", "idx_List", "]"}], ":=", 
    RowBox[{"V", "[", 
     RowBox[{"[", "idx", "]"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "gets", " ", "all", " ", "pairs", " ", "of", " ", "bags", " ", "that", " ",
     "intersect"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intersectingPairs", "[", "bags_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cands", ",", "result"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"cands", "=", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", "bags", ",", "bags", ",", "1"}], "]"}], "//", 
         "fl1"}]}], ";", "\n", "\t", 
       RowBox[{"Select", "[", 
        RowBox[{"cands", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "!=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{"!", 
            RowBox[{"disjoint", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&&", 
           RowBox[{"OrderedQ", "[", "#", "]"}]}], "&"}]}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "sorts", " ", "list", " ", "given", " ", "list", " ", "of", " ", 
     "partial", " ", "orders"}], ",", " ", 
    RowBox[{
    "and", " ", "give", " ", "first", " ", "result", "\[IndentingNewLine]", 
     RowBox[{"partialSortFirst", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "2"}], "}"}]}], "]"}], " ", "means", " ", 
     "a"}], ",", 
    RowBox[{
    "b", " ", "are", " ", "tied", " ", "for", " ", "first", " ", "position"}],
     ",", " ", 
    RowBox[{"c", " ", "is", " ", "in", " ", "second"}]}], 
   "\[IndentingNewLine]", " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"partialSortFirst", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "2"}], "}"}]}], "]"}], " ", "gives", " ", 
     "1"}], ",", "2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partialSortFirst", "[", 
    RowBox[{"items_", ",", "orders__"}], "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"ordList", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "orders", "}"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Length", "[", "items", "]"}], "==", 
       RowBox[{"Length", "[", "ordList", "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"best", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Sort", "@", "ordList"}]}]}], ";", "\n", "\t", 
     RowBox[{"poses", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"ordList", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "==", "best"}], "&"}], ")"}]}]}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Extract", "[", 
        RowBox[{"items", ",", "poses"}], "]"}], "]"}], "//", "First"}]}], 
    "\n", ")"}]}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "neighborhood", " ", "of", " ", "given", " ", "vertex", " ", 
    RowBox[{"set", ".", " ", "Vertices"}], " ", "in", " ", "the", " ", "set", 
    " ", "not", " ", 
    RowBox[{"included", "."}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"todo", ":", " ", 
    RowBox[{"rename", " ", "to", " ", "getAdjacent"}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getAdjacent", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "V"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getAdjacent", "[", "v_List", "]"}], ":=", 
   RowBox[{"(", " ", "\n", "\t", 
    RowBox[{
     RowBox[{"vArr", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vert2idx", "[", "v", "]"}], "->", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"\[LeftBracketingBar]", "v", "\[RightBracketingBar]"}]}], 
          "]"}]}], ",", 
        RowBox[{"\[LeftBracketingBar]", "V", "\[RightBracketingBar]"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"idx2vert", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"ArrayRules", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"adjMat", ".", "vArr"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "vArr"}], ")"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"HoldPattern", "[", 
          RowBox[{
           RowBox[{"{", "x_", "}"}], "->", 
           RowBox[{"_", "?", "Positive"}]}], "]"}], "->", "x"}]}], "]"}], 
      "]"}]}], "\n", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAdjacent", "[", "v_Integer", "]"}], ":=", 
    RowBox[{"getAdjacent", "[", 
     RowBox[{"{", "v", "}"}], "]"}]}], ";"}], "\n", "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"maximum", " ", "spanning", " ", "tree"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"spanningBagTree", "[", "bags_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"jtree", ",", "edgeCandidates", ",", "bestEdge", ",", "lens"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"return", " ", "all", " ", "possible", " ", "edges"}], ",", 
        " ", "ie", ",", " ", 
        RowBox[{"ones", " ", "that", " ", 
         RowBox[{"don", "'"}], "t", " ", "create", " ", "a", " ", "cycle", 
         " ", "in", " ", "current", " ", "jtree", " ", "graph"}]}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"acyclicEdges", "[", "ed_", "]"}], ":=", 
        RowBox[{"Select", "[", 
         RowBox[{"ed", ",", 
          RowBox[{
           RowBox[{"AcyclicGraphQ", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"UndirectedEdge", "@@@", 
              RowBox[{"(", 
               RowBox[{"jtree", "\[Tilde]", 
                RowBox[{"{", "#", "}"}]}], ")"}]}], "]"}], "]"}], "&"}]}], 
         "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "For", " ", "a", " ", "given", " ", "set", " ", "of", " ", 
          "junction", " ", "tree", " ", "edges"}], ",", " ", 
         RowBox[{
         "returns", " ", "one", " ", "with", " ", "largest", " ", 
          "intersection"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findHeaviestEdge", "[", "ed_", "]"}], ":=", 
        RowBox[{"(", "\n", "\t\t", 
         RowBox[{
          RowBox[{"lens", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"\[LeftBracketingBar]", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Intersection]", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[RightBracketingBar]"}], 
             "&"}], "/@", "ed"}]}], ";", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"lens", "==", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"ed", "[", 
             RowBox[{"[", 
              RowBox[{"Last", "@", 
               RowBox[{"Ordering", "@", "lens"}]}], "]"}], "]"}]}], "]"}]}], 
         "\n", "\t", ")"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "grow", " ", "the", " ", "tree", " ", "greedily", " ", "by", " ", 
          "one", " ", "edge"}], ",", " ", 
         RowBox[{
          RowBox[{"don", "'"}], "t", " ", "introduce", " ", "cycles"}]}], " ",
         "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"growTree", "[", "]"}], ":=", 
        RowBox[{"(", "\n", "\t\t", 
         RowBox[{
          RowBox[{"bestEdge", "=", 
           RowBox[{"findHeaviestEdge", "[", "edgeCandidates", "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"jtree", "=", 
           RowBox[{"jtree", "\[Tilde]", 
            RowBox[{"{", "bestEdge", "}"}]}]}], ";", "\n", "\t\t", 
          RowBox[{"edgeCandidates", "=", 
           RowBox[{"edgeCandidates", "\[Backslash]", 
            RowBox[{"{", "bestEdge", "}"}]}]}], ";", "\n", "\t\t", 
          RowBox[{"edgeCandidates", "=", 
           RowBox[{"acyclicEdges", "[", "edgeCandidates", "]"}]}], ";"}], 
         "\n", "\t", ")"}]}], ";", "\n", "\t", 
       RowBox[{"edgeCandidates", "=", 
        RowBox[{"intersectingPairs", "[", "bags", "]"}]}], ";", "\n", "\t", 
       RowBox[{"jtree", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"edgeCandidates", "!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"growTree", "[", "]"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"Sort", "[", "jtree", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "True", " ", "if", " ", "bag", " ", "is", " ", "contained",
     " ", "inside", " ", "any", " ", "other", " ", "bag", " ", "in", " ", 
    "bags"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isBagRedundant", "[", "bag_", "]"}], ":=", 
    RowBox[{"anyTrue", "[", 
     RowBox[{
      RowBox[{"b", "\[Element]", "bags"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "!=", "bag"}], ")"}], "\[And]", 
       RowBox[{"(", 
        RowBox[{"bag", "\[Subset]", "b"}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Produce", " ", "list", " ", "of", " ", "bags"}], ",", " ", 
    RowBox[{
    "and", " ", "pairs", " ", "of", " ", "adjacent", " ", "bags", " ", "that",
      " ", "form", " ", "a", " ", "junction", " ", "tree"}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"treeDecomposition", "[", "gr_Graph", "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"g", "=", "gr"}], ";", "\n", "\t", 
      RowBox[{"V", "=", 
       RowBox[{"VertexList", "[", "g", "]"}]}], ";", "\n", "\t", 
      RowBox[{"adjMat", "=", 
       RowBox[{"AdjacencyMatrix", "[", "g", "]"}]}], ";", "\n", "\t", 
      RowBox[{"elimed", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "nodes", " ", "that", " ", "have", " ", "been",
         " ", "eliminated"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"bags", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"junction", " ", "tree", " ", "bags"}], ",", " ", 
        RowBox[{"like", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], " ", "*)"}], "\n", "\t", 
      
      RowBox[{"tieBreaker", "=", "V"}], ";", "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[LeftBracketingBar]", "elimed", "\[RightBracketingBar]"}], 
         "<", 
         RowBox[{"\[LeftBracketingBar]", "V", "\[RightBracketingBar]"}]}], 
        ",", 
        RowBox[{"minFillEliminate", "[", "]"}]}], "]"}], ";", 
      RowBox[{"bags", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"bags", ",", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"isBagRedundant", "[", "#", "]"}], "]"}], "&"}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"jedges", "=", 
       RowBox[{"spanningBagTree", "[", "bags", "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"bags", ",", "jedges"}], "}"}]}], "\n", "\n", ")"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "connected", " ", "components", " ", "of", " ", "graph", " ", "restricted",
     " ", "to", " ", "vertex", " ", "set"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"connComps", "[", "v_", "]"}], ":=", 
    RowBox[{"ConnectedComponents", "[", 
     RowBox[{"Subgraph", "[", 
      RowBox[{"g", ",", "v"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Eliminate", " ", "single", " ", 
     RowBox[{"vertex", ".", " ", 
      RowBox[{"Globals", ":", " ", "elimed"}]}]}], ",", " ", "V", ",", " ", 
    "bags"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"elimVertex", "[", "v_", "]"}], ":=", 
    RowBox[{"(", " ", "\n", "\t", 
     RowBox[{
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"v", "\[Element]", "elimed"}], ")"}]}], ",", 
        "\"\<Duplicate elimination\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\n", "\t", 
      RowBox[{"comps", "=", 
       RowBox[{"connComps", "[", 
        RowBox[{"V", "\[Backslash]", "elimed"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "componet", " ", "containing", " ", "vertex", " ", "to", " ", "be", 
        " ", "eliminated"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"ourComp", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"comps", ",", 
          RowBox[{
           RowBox[{"v", "\[Element]", "#"}], "&"}]}], "]"}], "//", 
        "First"}]}], ";", "\n", "\t", 
      RowBox[{"boundary", "=", 
       RowBox[{"getAdjacent", "[", "ourComp", "]"}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"bags", ",", 
        RowBox[{"boundary", "\[Union]", 
         RowBox[{"{", "v", "}"}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"elimed", ",", "v"}], "]"}], ";"}], "\n", ")"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "negative", " ", "number", " ", "of", " ", "edges", " ", 
    "in", " ", "bag", " ", "created", " ", "for", " ", "each", " ", "member", 
    " ", "of", " ", "verts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"todo", ":", " ", 
     RowBox[{"once", " ", "we", " ", "have", " ", "tests"}]}], ",", " ", 
    RowBox[{
    "return", " ", "number", " ", "of", " ", "fill", " ", "edges", " ", 
     "instead"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getFillValues", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getFillValues", "[", "verts_List", "]"}], ":=", 
    RowBox[{"(", " ", "\n", "\t", 
     RowBox[{
      RowBox[{"Assert", "[", 
       RowBox[{"ValueQ", "[", "elimed", "]"}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"elimed", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{
           "\[LeftBracketingBar]", "verts", "\[RightBracketingBar]"}]}], 
          "]"}], "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"elimArr", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vert2idx", "[", "elimed", "]"}], "->", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{
            "\[LeftBracketingBar]", "elimed", "\[RightBracketingBar]"}]}], 
           "]"}]}], ",", 
         RowBox[{"\[LeftBracketingBar]", "V", "\[RightBracketingBar]"}]}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"getFillSingleVert", "[", "v_", "]"}], ":=", 
       RowBox[{"(", " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{"vArr", "=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vert2idx", "[", 
              RowBox[{"{", "v", "}"}], "]"}], "->", "1"}], ",", 
            RowBox[{"\[LeftBracketingBar]", "V", "\[RightBracketingBar]"}]}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"touchArr", "=", 
          RowBox[{"adjMat", ".", "vArr"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "all", " ", "vertices", " ", "adjacent", " ", "to", " ", 
            "elimination", " ", "candidate"}], " ", "+", " ", 
           RowBox[{"elimination", " ", "candidate"}]}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{"cliqueArr", "=", 
          RowBox[{
           RowBox[{"elimArr", " ", "touchArr"}], "+", "vArr"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "number", " ", "of", " ", "undirected", " ", "edges", " ", "in", 
           " ", "graph", " ", "restricted", " ", "to", " ", "cliqueArr"}], 
          " ", "*)"}], " ", "\n", "\t\t", 
         RowBox[{"numEdges", "=", 
          RowBox[{
           RowBox[{"cliqueArr", ".", "adjMat", ".", "cliqueArr"}], "/", 
           "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"-", "numEdges"}]}], "\n", "\t", ")"}]}], ";", "\n", "\t", 
      RowBox[{"getFillSingleVert", "/@", "verts"}]}], "\n", ")"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Single", " ", "step", " ", "of", " ", "min"}], "-", 
     RowBox[{"fill", " ", "elimination"}]}], ",", " ", 
    RowBox[{"Globals", ":", " ", "elimed"}], ",", " ", "V", ",", " ", 
    "tieBreaker"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"minFillEliminate", "[", "]"}], ":=", 
    RowBox[{"(", " ", "\n", "\t", 
     RowBox[{
      RowBox[{"frontier", "=", 
       RowBox[{"getAdjacent", "[", "elimed", "]"}]}], ";", "\n", "\t", 
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{"frontier", "!=", 
         RowBox[{"{", "}"}]}], ",", 
        "\"\<Either nothing left to eliminate or graph not connected\>\""}], 
       "]"}], ";", "\n", "\t", 
      RowBox[{"fillVals", "=", 
       RowBox[{"getFillValues", "[", "frontier", "]"}]}], ";", "\n", "\t", 
      RowBox[{"tieVals", "=", 
       RowBox[{"tieBreaker", "[", 
        RowBox[{"[", "frontier", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"elimVertex", "[", 
       RowBox[{"partialSortFirst", "[", 
        RowBox[{
        "frontier", ",", "fillVals", ",", "tieVals", ",", "frontier"}], "]"}],
        "]"}]}], "\n", ")"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "checks", " ", "that", " ", "\"\<bags/jedges\>\"", " ", "forms", " ", "a", 
    " ", "junction", " ", "tree", " ", "of", " ", "g"}], " ", "*)"}]}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkTreeDecomposition", "[", 
     RowBox[{"g_", ",", 
      RowBox[{"{", 
       RowBox[{"bags_", ",", "jedges_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"isok", "=", "True"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "every", " ", "node", " ", "must", " ", "be", " ", "contained", " ", 
        "in", " ", "some", " ", "bag"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"existNodes", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"VertexList", "[", "g", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"coveredNodes", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "bags", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"prop", "=", 
       RowBox[{"(", 
        RowBox[{"existNodes", "===", "coveredNodes"}], ")"}]}], ";", "\n", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "prop"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<checkTreeDecomposition: violates variable preservation for \
\>\"", ",", 
           RowBox[{"existNodes", "\[Backslash]", "coveredNodes"}]}], "]"}], 
         ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "every", " ", "edge", " ", "should", " ", "be", " ", "contained", " ", 
        "in", " ", "some", " ", "bag"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"existFactors", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"List", "@@@", 
         RowBox[{"EdgeList", "[", "g", "]"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"coveredFactors", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"existFactors", ",", 
          RowBox[{
           RowBox[{"anyTrue", "[", 
            RowBox[{
             RowBox[{"bag", "\[Element]", "bags"}], ",", 
             RowBox[{"#", "\[Subset]", "bag"}]}], "]"}], "&"}]}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"prop", "=", 
       RowBox[{"(", 
        RowBox[{"existFactors", "===", "coveredFactors"}], ")"}]}], ";", "\n",
       "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "prop"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<checkTreeDecomposition: violates factor preservation for \>\"",
            ",", 
           RowBox[{"existFactors", "\[Backslash]", "coveredFactors"}]}], 
          "]"}], ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\n", "    ", 
      RowBox[{
       RowBox[{"isSeparator", "[", 
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"\[LeftBracketingBar]", 
         RowBox[{"ConnectedComponents", "[", 
          RowBox[{"Subgraph", "[", 
           RowBox[{"g", ",", 
            RowBox[{"V", "\[Backslash]", 
             RowBox[{"(", 
              RowBox[{"i", "\[Intersection]", "j"}], ")"}]}]}], "]"}], "]"}], 
         "\[RightBracketingBar]"}], ">", "1"}]}], ";", "\n", "    ", 
      RowBox[{"separatingEdges", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"jedges", ",", 
         RowBox[{
          RowBox[{"isSeparator", "[", "#", "]"}], "&"}]}], "]"}]}], ";", "\n",
       "\t", 
      RowBox[{"prop", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", "separatingEdges", "]"}], "===", 
         RowBox[{"Union", "[", "jedges", "]"}]}], ")"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "prop"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<checkTreeDecomposition: violates running intersection for \
\>\"", ",", 
           RowBox[{"jedges", "\[Backslash]", "separatingEdges"}]}], "]"}], 
         ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\n", "\t", 
      RowBox[{"gg", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"bags", ",", 
         RowBox[{"UndirectedEdge", "@@@", "jedges"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"prop", "=", 
       RowBox[{"ConnectedGraphQ", "[", "gg", "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "prop"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<checkTreeDecomposition: tree not connected, have following cc \
sizes \>\"", ",", 
           RowBox[{"Length", "/@", 
            RowBox[{"ConnectedComponents", "[", "gg", "]"}]}]}], "]"}], ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "following", " ", "check", " ", "can", " ", "subsume", " ", "the", " ",
         "previous", " ", "two", " ", "if", " ", "we", " ", "allow", " ", 
        "Junction", " ", "Forests"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"seps", "=", 
       RowBox[{"Intersection", "@@@", "jedges"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"sepCount", "[", "x_", "]"}], ":=", 
       RowBox[{"Length", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"seps", ",", 
          RowBox[{
           RowBox[{"x", "\[Element]", "#"}], "&"}]}], "]"}]}]}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"bagCount", "[", "x_", "]"}], ":=", 
       RowBox[{"Length", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"bags", ",", 
          RowBox[{
           RowBox[{"x", "\[Element]", "#"}], "&"}]}], "]"}]}]}], ";", "\n", 
      "\t", 
      RowBox[{"vars", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Flatten", "@", "jedges"}]}]}], ";", "\n", "\t", 
      RowBox[{"counts", "=", 
       RowBox[{"table", "[", 
        RowBox[{
         RowBox[{"x", "\[Element]", "vars"}], ",", 
         RowBox[{
          RowBox[{"bagCount", "[", "x", "]"}], "-", 
          RowBox[{"sepCount", "[", "x", "]"}]}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"failures", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"Position", "[", 
          RowBox[{"counts", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "!=", "1"}], "&"}], ")"}]}]}], "]"}]}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"failures", "==", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "prop"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<checkTreeDecomposition: generalized running intersection \
violated for \>\"", ",", "failures"}], "]"}], ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"data", " ", "structure", " ", "checks"}], " ", "*)"}], "\n", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"allTrue", "[", 
          RowBox[{
           RowBox[{"e", "\[Element]", "jedges"}], ",", 
           RowBox[{"OrderedQ", "[", "e", "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<checkTreeDecomposition: some edge is not ordered\>\"", "]"}], 
         ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"allTrue", "[", 
          RowBox[{
           RowBox[{"e", "\[Element]", "bags"}], ",", 
           RowBox[{"OrderedQ", "[", "e", "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<checkTreeDecomposition: some node is not ordered\>\"", "]"}], 
         ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"OrderedQ", "[", "jedges", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<checkTreeDecomposition: edges are not ordered\>\"", "]"}], ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"OrderedQ", "[", "bags", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<checkTreeDecomposition: nodes are not ordered\>\"", "]"}], ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"fl1", "@", "jedges"}], "]"}], "!=", "bags"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<nodes and edges don't match\>\"", "]"}], 
         ";", 
         RowBox[{"isok", "=", "False"}]}]}], "]"}], ";", "\n", "\n", "\t", 
      "isok"}], "\n", ")"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "gives", " ", "number", " ", "of", " ", "basic", " ", "operations", " ", 
    "needed", " ", "to", " ", "evaluate", " ", "given", " ", "tree", " ", 
    "decomposition"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTreeCost", "[", 
     RowBox[{"{", 
      RowBox[{"nodes_List", ",", "edges_List"}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"edgeCost", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"\[LeftBracketingBar]", 
          RowBox[{"a", "\[Intersection]", "b"}], "\[RightBracketingBar]"}]}], 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "^", 
           RowBox[{"\[LeftBracketingBar]", 
            RowBox[{"a", "\[Backslash]", "b"}], "\[RightBracketingBar]"}]}], 
          "+", 
          RowBox[{"2", "^", 
           RowBox[{"\[LeftBracketingBar]", 
            RowBox[{"b", "\[Backslash]", "a"}], "\[RightBracketingBar]"}]}]}],
          ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"sum", "[", 
       RowBox[{
        RowBox[{"e", "\[Element]", "edges"}], ",", 
        RowBox[{"edgeCost", "[", "e", "]"}]}], "]"}]}], "\n", ")"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"gives", " ", "tree", " ", "width", " ", 
    RowBox[{"(", 
     RowBox[{"size", " ", "of", " ", "largest", " ", "bag"}], ")"}], " ", 
    "of", " ", "given", " ", "tree", " ", "decomposition"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTreeWidth", "[", 
     RowBox[{"{", 
      RowBox[{"nodes_List", ",", "edges_List"}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"bags", "=", 
       RowBox[{"fl1", "[", "edges", "]"}]}], ";", "\n", "\t", 
      RowBox[{"Max", "[", 
       RowBox[{"Length", "/@", "bags"}], "]"}]}], "\n", ")"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "Visualization", " ", "Utils"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initGraph", "[", "g_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initializing", " ", "graph"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"CycleGraph", "[", 
         RowBox[{"8", ",", 
          RowBox[{"VertexShapeFunction", "\[Rule]", "shapeFunc"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
            RowBox[{"2", "\[UndirectedEdge]", "3"}], ",", 
            RowBox[{"2", "\[UndirectedEdge]", "9"}], ",", 
            RowBox[{"5", "\[UndirectedEdge]", "4"}], ",", 
            RowBox[{"3", "\[UndirectedEdge]", "4"}], ",", 
            RowBox[{"4", "\[UndirectedEdge]", "8"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "5"}], ",", 
            RowBox[{"5", "\[UndirectedEdge]", "6"}], ",", 
            RowBox[{"6", "\[UndirectedEdge]", "7"}], ",", 
            RowBox[{"5", "\[UndirectedEdge]", "10"}], ",", 
            RowBox[{"10", "\[UndirectedEdge]", "7"}], ",", 
            RowBox[{"7", "\[UndirectedEdge]", "8"}], ",", 
            RowBox[{"9", "\[UndirectedEdge]", "4"}]}], "}"}], ",", 
          RowBox[{"VertexShapeFunction", "\[Rule]", "shapeFunc"}]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initializing", " ", "Graphics"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"masterScale", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lineThickness", "=", ".5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertSize", "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vcoords", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"VertexList", "[", "g", "]"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"VertexCoordinates", "/.", 
           RowBox[{"AbsoluteOptions", "[", 
            RowBox[{"g", ",", "VertexCoordinates"}], "]"}]}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"GridGraph", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"VertexShapeFunction", "\[Rule]", "shapeFunc"}]}], "]"}]}],
         ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"EdgeList", "[", "g", "]"}], ",", 
         RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}], ",", 
         RowBox[{"VertexShapeFunction", "\[Rule]", "shapeFunc"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"VertexList", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"elimed", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bags", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"graphPR", "=", 
       RowBox[{"getPlotRange", "[", 
        RowBox[{"V", "/.", "vcoords"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphPR", "=", 
       RowBox[{"correctPR", "[", 
        RowBox[{"graphPR", ",", "masterScale"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphIS", "=", 
       RowBox[{
        RowBox[{"-", "masterScale"}], " ", 
        RowBox[{"Subtract", "@@@", "graphPR"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphStyle", "=", "\"\<DiagramBlack\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colorList", "=", 
       RowBox[{"ColorData", "[", 
        RowBox[{"\"\<Atoms\>\"", ",", "\"\<ColorList\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bags", ",", "jedges"}], "}"}], "=", 
       RowBox[{"treeDecomposition", "[", "g", "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"correctPR", "[", 
    RowBox[{"pr_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pr", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "scale"}], ",", 
        RowBox[{"2", "/", "scale"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"pr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "/", "scale"}], ",", 
        RowBox[{"1", "/", "scale"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPlotRange", "[", "lst_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xs", ",", "ys"}], "}"}], "=", 
       RowBox[{"Transpose", "[", "lst", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"two", " ", "extra", " ", 
        RowBox[{"1", "/", "scale"}], " ", "offsets", " ", "needed", " ", 
        "for", " ", "exact", " ", "match"}], "*)"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", "xs", "]"}], "-", 
           RowBox[{"lineThickness", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"Max", "[", "xs", "]"}], "+", 
           RowBox[{"lineThickness", "/", "2"}], "+", 
           RowBox[{"1", "/", "masterScale"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", "ys", "]"}], "-", 
           RowBox[{"lineThickness", "/", "2"}], "-", 
           RowBox[{"1", "/", "masterScale"}]}], ",", 
          RowBox[{
           RowBox[{"Max", "[", "ys", "]"}], "+", 
           RowBox[{"lineThickness", "/", "2"}]}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertexClick", "[", "v_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<eliminating \>\"", ",", "v"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"elim", "[", "v", "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"regular", " ", "ymin"}], "-", "1"}], ",", 
    RowBox[{"xmax", "+", "1"}], ",", " ", 
    RowBox[{
    "and", " ", "addition", " ", "1", " ", "pixel", " ", "for", " ", 
     "antialiasing"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeVertex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", "v_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotRange", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "-", 
          RowBox[{"vertSize", "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "+", 
          RowBox[{"vertSize", "/", "2"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotRange", "=", 
      RowBox[{"correctPR", "[", 
       RowBox[{"plotRange", ",", "masterScale"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imageSize", "=", 
      RowBox[{
       RowBox[{"-", "masterScale"}], " ", 
       RowBox[{"Subtract", "@@@", "plotRange"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"button", "=", 
      RowBox[{"{", 
       RowBox[{"Transparent", ",", 
        RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"vertSize", "/", "2"}]}], "]"}], ",", 
          RowBox[{"vertexClick", "[", "v", "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"label", "=", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"v", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", "Bold", ",", 
          "14"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"label", "\[Tilde]", "button"}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shapeFunc", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", "v_", ",", 
      RowBox[{"{", 
       RowBox[{"w_", ",", "h_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"makeVertex", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "v"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"drawBag", "[", 
     RowBox[{"bag_List", ",", 
      RowBox[{"scale_:", "masterScale"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bagGraph", "=", 
       RowBox[{"Subgraph", "[", 
        RowBox[{"g", ",", "bag", ",", 
         RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}], ",", 
         RowBox[{"GraphStyle", "->", "graphStyle"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tileEnds", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", "bag", ",", "bag"}], "]"}], "//", "fl1"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[LessEqual]", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"FindShortestPath", "[", 
          RowBox[{
           RowBox[{"CompleteGraph", "[", 
            RowBox[{"Length", "[", "V", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
        "tileEnds"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"bagColor", "=", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"colorList", ",", 
            RowBox[{"Position", "[", 
             RowBox[{"nrBags", ",", "bag"}], "]"}]}], "]"}], "//", 
          "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"bagColor", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"colorList", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"tileOpts", "=", 
       RowBox[{"{", 
        RowBox[{"bagColor", ",", 
         RowBox[{"AbsoluteThickness", "[", 
          RowBox[{"lineThickness", "*", "scale"}], "]"}], ",", 
         RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
         RowBox[{"JoinForm", "[", "\"\<Round\>\"", "]"}], ",", 
         RowBox[{"Opacity", "[", ".8", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allPoints", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"tiles", "/.", "vcoords"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"getPlotRange", "[", "allPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imSize", "=", 
       RowBox[{
        RowBox[{"-", "scale"}], "*", 
        RowBox[{"Subtract", "@@@", "plotRange"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tileG", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"tileOpts", "~", "Join", "~", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"#", "/.", "vcoords"}], "]"}], "&"}], "/@", "tiles"}], 
           ")"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imSize"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drawBags", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nrBags", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"bags", ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"isBagRedundant", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Sequence", "@@", 
        RowBox[{"(", 
         RowBox[{"drawBag", "/@", "nrBags"}], ")"}]}], ",", "gg", ",", 
       RowBox[{"PlotRange", "\[Rule]", "graphPR"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "graphIS"}]}], "]"}]}], 
    "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"drawBagOnGraph", "[", "bag_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nrBags", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"bags", ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"isBagRedundant", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"drawBag", "@", "bag"}], ",", "gg", ",", 
        RowBox[{"PlotRange", "\[Rule]", "graphPR"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "graphIS"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"drawGraphFragment", "[", 
     RowBox[{"bag_", ",", 
      RowBox[{"scale_:", "masterScale"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bagGraph", "=", 
       RowBox[{"Subgraph", "[", 
        RowBox[{"g", ",", "bag"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allPoints", "=", 
       RowBox[{"bag", "/.", "vcoords"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"getPlotRange", "[", "allPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imSize", "=", 
       RowBox[{
        RowBox[{"-", "scale"}], "*", 
        RowBox[{"Subtract", "@@@", "plotRange"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Subgraph", "[", 
       RowBox[{"g", ",", "bag", ",", 
        RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
        RowBox[{"GraphStyle", "\[Rule]", "\"\<SimpleLink\>\""}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", "Transparent"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "imSize"}], ",", 
        RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"visGraph", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"maximum", " ", "spanning", " ", "tree"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nrBags", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"bags", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"isBagRedundant", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"jedges", "=", 
       RowBox[{"makeSpanningBagTree", "[", "nrBags", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bagCentroid", "[", "bag_", "]"}], ":=", 
       RowBox[{"Mean", "[", 
        RowBox[{"bag", "/.", "vcoords"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"findExtremeBag", "[", "vec_", "]"}], ":=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vertList", "=", 
          RowBox[{"First", "/@", "vcoords"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coordList", "=", 
          RowBox[{"Last", "/@", "vcoords"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"goodBags", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bags", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"extremePos", "=", 
          RowBox[{"First", "[", 
           RowBox[{"Ordering", "[", 
            RowBox[{"goodBags", ",", "1", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"bagCentroid", "[", "#1", "]"}], ".", "vec"}], ">", 
               RowBox[{
                RowBox[{"bagCentroid", "[", "#2", "]"}], ".", "vec"}]}], 
              "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"goodBags", "[", 
          RowBox[{"[", "extremePos", "]"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}], ";", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"extremeDirs", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extremeBags", "=", 
       RowBox[{"findExtremeBag", "/@", "extremeDirs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extremePoses", "=", 
       RowBox[{"bagCentroid", "/@", "extremeBags"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", " ", "Show"}], " ", "bags", " ", "as", " ", "vertices", 
        " ", "of", " ", "another", " ", "GraphPlot"}], " ", "***)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"scale", "=", "50"}], ";", "\[IndentingNewLine]", 
      RowBox[{"jgraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Rule", "@@@", "jedges"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "special", " ", "handling", " ", "for", " ", "path", " ", "graphs", 
        " ", "since", " ", "extreme", " ", "positions", " ", "lie", " ", "on",
         " ", "a", " ", "line"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vrules", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PathGraphQ", "[", "jgraph", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"First", "[", "bags", "]"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Thread", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"extremeBags", "\[Rule]", "extremePoses"}], "]"}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GraphPlot", "[", 
       RowBox[{"jgraph", ",", "\[IndentingNewLine]", 
        RowBox[{"VertexRenderingFunction", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"drawBag", "[", 
                RowBox[{"#2", ",", "scale"}], "]"}], ",", 
               RowBox[{"drawGraphFragment", "[", 
                RowBox[{"#2", ",", "scale"}], "]"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"EdgeRenderingFunction", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Gray", ",", "Thick", ",", 
             RowBox[{"Arrowheads", "[", ".0", "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"#1", ",", ".0"}], "]"}]}], "}"}], "&"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexCoordinateRules", "\[Rule]", "vrules"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", "graphPR"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1.5", "graphIS"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0FsoQwEABuAZuS0aISW1oSRsOLmELHIpO26bPBDDTGbMIZcHJK2QyzFS
hghReJDNWKGWyBOFISEP4mkS5cVGc/7z8Pc9/f31C+vbZCouh8MRMoHzgjxK
ZbFnu8jaDrguNMS3MJp1viKY81FCQEFMFevzwkUqVM07WFOqHjOhXOIvgXpd
ejV0kmoF/A4NaoJag10DP2VbFByq6O6AdaNevfBsx78PXk3nTsEneoR16880
B+9cthXoHUVvsLtWqRGaxI378DzpxALHHZJrGKGU38K108MnWOrcfYfDl6+f
MMTCd8D6oxe3Vsawt00uLAw28mBKQkYgLJZ5JsKl30ECTsqNWbBs9Tgfdsoe
SFjOXVRCfUmkFhbE3bMu89K6YCp1OwAbsmOG4ZSNGoU14yTN9vgeC5COFd7A
2YkxO3SKiS/YE6D+gWZa/AdvxqJd8EW1567FLwcaT1gklYZBKvkuHPavWLeh
q3LGCJujRTaKka8g7mH+tdavnbHbR8/6D99HFrs=
  
  "],ExpressionUUID->"efa2eec1-1487-4d6a-b779-b60fdf424bea"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.720054904895276*^9, 
  3.720054916092799*^9}},ExpressionUUID->"21f4ce8a-7505-4b7f-8c98-\
c9cc8f62cba8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"GridGraph", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"GraphStyle", "\[Rule]", "\"\<DiagramBlue\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "g", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"target", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "6", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "6", ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeDecomposition", "[", "g", "]"}], "\[Equal]", 
  "target"}], "\[IndentingNewLine]", 
 RowBox[{"checkTreeDecomposition", "[", 
  RowBox[{"g", ",", 
   RowBox[{"treeDecomposition", "[", "g", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getCost", "[", "n_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"GridGraph", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "n"}], "}"}], ",", 
       RowBox[{"GraphStyle", "\[Rule]", "\"\<DiagramBlue\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"getTreeCost", "[", 
     RowBox[{"treeDecomposition", "[", "g", "]"}], "]"}]}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"getCost", "/@", 
   RowBox[{"Range", "[", "10", "]"}]}], "]"}]}], "Input",ExpressionUUID->\
"ee406a65-7451-426c-9309-2ff1106a3688"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {Null, 
       SparseArray[
       Automatic, {8, 8}, 0, {
        1, {{0, 2, 4, 7, 10, 13, 16, 18, 20}, {{2}, {3}, {1}, {4}, {1}, {4}, {
          5}, {2}, {3}, {6}, {3}, {6}, {7}, {4}, {5}, {8}, {5}, {8}, {6}, {
          7}}}, Pattern}]}, {
      GraphLayout -> {"GridEmbedding", "Dimension" -> {2, 4}}, GraphStyle -> 
       "DiagramBlue"}]], Typeset`boxes, Typeset`boxes$s2d = GraphicsGroupBox[{{
       Directive[
        GrayLevel[0.5], 
        Opacity[1]], 
       LineBox[{
         DynamicLocation["VertexID$1", Automatic, Center], 
         DynamicLocation["VertexID$2", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$1", Automatic, Center], 
         DynamicLocation["VertexID$3", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$2", Automatic, Center], 
         DynamicLocation["VertexID$4", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$3", Automatic, Center], 
         DynamicLocation["VertexID$4", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$3", Automatic, Center], 
         DynamicLocation["VertexID$5", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$4", Automatic, Center], 
         DynamicLocation["VertexID$6", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$5", Automatic, Center], 
         DynamicLocation["VertexID$6", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$5", Automatic, Center], 
         DynamicLocation["VertexID$7", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$6", Automatic, Center], 
         DynamicLocation["VertexID$8", Automatic, Center]}], 
       LineBox[{
         DynamicLocation["VertexID$7", Automatic, Center], 
         DynamicLocation["VertexID$8", Automatic, Center]}]}, {
       Directive[
        Hue[0.6, 0.3, 0.8], 
        EdgeForm[]], 
       TagBox[{
         TagBox[
          
          RectangleBox[{0.8325858583930258, 0.8883902560342511}, {
           1.167414141606974, 1.1116097439657489`}], "DynamicName", BoxID -> 
          "VertexID$1"], 
         InsetBox[
          FormBox["1", TraditionalForm], 
          DynamicLocation["VertexID$1", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$1"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{0.8325858583930258, 1.8883902560342511`}, {
           1.167414141606974, 2.1116097439657486`}], "DynamicName", BoxID -> 
          "VertexID$2"], 
         InsetBox[
          FormBox["2", TraditionalForm], 
          DynamicLocation["VertexID$2", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$2"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{1.832585858393026, 0.8883902560342511}, {
           2.167414141606974, 1.1116097439657489`}], "DynamicName", BoxID -> 
          "VertexID$3"], 
         InsetBox[
          FormBox["3", TraditionalForm], 
          DynamicLocation["VertexID$3", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$3"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{1.832585858393026, 1.8883902560342511`}, {
           2.167414141606974, 2.1116097439657486`}], "DynamicName", BoxID -> 
          "VertexID$4"], 
         InsetBox[
          FormBox["4", TraditionalForm], 
          DynamicLocation["VertexID$4", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$4"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{2.832585858393026, 0.8883902560342511}, {
           3.167414141606974, 1.1116097439657489`}], "DynamicName", BoxID -> 
          "VertexID$5"], 
         InsetBox[
          FormBox["5", TraditionalForm], 
          DynamicLocation["VertexID$5", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$5"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{2.832585858393026, 1.8883902560342511`}, {
           3.167414141606974, 2.1116097439657486`}], "DynamicName", BoxID -> 
          "VertexID$6"], 
         InsetBox[
          FormBox["6", TraditionalForm], 
          DynamicLocation["VertexID$6", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$6"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{3.832585858393026, 0.8883902560342511}, {
           4.167414141606974, 1.1116097439657489`}], "DynamicName", BoxID -> 
          "VertexID$7"], 
         InsetBox[
          FormBox["7", TraditionalForm], 
          DynamicLocation["VertexID$7", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> "VertexLabelID$7"], 
       TagBox[{
         TagBox[
          
          RectangleBox[{3.832585858393026, 1.8883902560342511`}, {
           4.167414141606974, 2.1116097439657486`}], "DynamicName", BoxID -> 
          "VertexID$8"], 
         InsetBox[
          FormBox["8", TraditionalForm], 
          DynamicLocation["VertexID$8", None, Center], BaseStyle -> 
          "Graphics"]}, "DynamicName", BoxID -> 
        "VertexLabelID$8"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{7.179999999999993, 351.81999999999994`}, {-66.1072, 
       60.30721433212919}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.720054999862218*^9, 
  3.7200551698296423`*^9},ExpressionUUID->"2c56b142-1640-44ae-8897-\
5e5bc8fde2e9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.720054999862218*^9, 
  3.7200551698414583`*^9},ExpressionUUID->"185190cb-3843-46aa-b400-\
edf845af02c2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.720054999862218*^9, 
  3.7200551698471613`*^9},ExpressionUUID->"20be4f42-9c2a-4b66-bc94-\
106cee6637dc"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.}, {2., 16.}, {3., 48.}, {4., 80.}, {5., 112.}, {6., 
      144.}, {7., 176.}, {8., 208.}, {9., 240.}, {10., 
      272.}}]}, {}}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10.}, {0, 272.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.720054999862218*^9, 
  3.720055170049027*^9},ExpressionUUID->"dcad0950-957c-4e41-a0c7-\
11cfc7aa8007"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"GridGraph", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initGraph", "[", "g", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"drawBagOnGraph", "/@", "bags"}]}], "Input",
 CellChangeTimes->{
  3.720055016771935*^9},ExpressionUUID->"35f2da2a-dda2-4b71-8ee4-\
a37ff727fdf3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{1., 1.}}], 
      LineBox[{{1., 1.}, {1., 2.}}], LineBox[{{1., 1.}, {2., 1.}}], 
      LineBox[{{1., 2.}}], LineBox[{{1., 2.}, {2., 1.}}], 
      LineBox[{{2., 1.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}], ",", 
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{1., 2.}}], 
      LineBox[{{1., 2.}, {2., 1.}}], LineBox[{{1., 2.}, {2., 2.}}], 
      LineBox[{{2., 1.}}], LineBox[{{2., 1.}, {2., 2.}}], 
      LineBox[{{2., 2.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}], ",", 
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{2., 1.}}], 
      LineBox[{{2., 1.}, {2., 2.}}], LineBox[{{2., 1.}, {3., 1.}}], 
      LineBox[{{2., 2.}}], LineBox[{{2., 2.}, {3., 1.}}], 
      LineBox[{{3., 1.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}], ",", 
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{2., 2.}}], 
      LineBox[{{2., 2.}, {3., 1.}}], LineBox[{{2., 2.}, {3., 2.}}], 
      LineBox[{{3., 1.}}], LineBox[{{3., 1.}, {3., 2.}}], 
      LineBox[{{3., 2.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}], ",", 
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{3., 1.}}], 
      LineBox[{{3., 1.}, {3., 2.}}], LineBox[{{3., 1.}, {4., 1.}}], 
      LineBox[{{3., 2.}}], LineBox[{{3., 2.}, {4., 1.}}], 
      LineBox[{{4., 1.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}], ",", 
   GraphicsBox[{
     {RGBColor[0.65, 0.7, 0.7], AbsoluteThickness[50.], Opacity[0.8], CapForm[
      "Round"], JoinForm["Round"], LineBox[{{3., 2.}}], 
      LineBox[{{3., 2.}, {4., 1.}}], LineBox[{{3., 2.}, {4., 2.}}], 
      LineBox[{{4., 1.}}], LineBox[{{4., 1.}, {4., 2.}}], 
      LineBox[{{4., 2.}}]}, {
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {1., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 1.}, {2., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{1., 2.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {2., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 1.}, {3., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{2., 2.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {3., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 1.}, {4., 1.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{3., 2.}, {4., 2.}}, 0.030239520958083826`]}, 
       {Arrowheads[0.], 
        ArrowBox[{{4., 1.}, {4., 2.}}, 0.030239520958083826`]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
        {GrayLevel[0], 
         StyleBox[InsetBox["1", {1., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[1], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["2", {1., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{1., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[2], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["3", {2., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[3], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["4", {2., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{2., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[4], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["5", {3., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[5], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["6", {3., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{3., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[6], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["7", {4., 1.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 1.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[7], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}, {
        {GrayLevel[0], 
         StyleBox[InsetBox["8", {4., 2.}],
          StripOnInput->False,
          FontSize->14,
          FontWeight->Bold]}, 
        {GrayLevel[0], Opacity[0], EdgeForm[Thickness[Large]], 
         TagBox[DiskBox[{4., 2.}, NCache[Rational[1, 4], 0.25]],
          
          EventHandlerTag[{
           "MouseClicked" :> $CellContext`vertexClick[8], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
            True}]]}}}}},
    ImageSize->{353.9999999999999, 153.99999999999997`},
    PlotRange->{{0.74, 4.279999999999999}, {0.72, 2.26}}]}], "}"}]], "Output",\

 CellChangeTimes->{3.720055017954976*^9, 
  3.720055173424137*^9},ExpressionUUID->"81a006db-0b80-4514-bb3a-\
49ffae2da0f2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{19, Automatic}, {Automatic, 45}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 187, 3, 30, "Text", "ExpressionUUID" -> \
"2aaadf99-5258-4061-a67b-04c38125bd57"],
Cell[748, 25, 52602, 1376, 7063, "Input", "ExpressionUUID" -> \
"efa2eec1-1487-4d6a-b779-b60fdf424bea",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[53375, 1405, 149, 3, 64, "Section", "ExpressionUUID" -> \
"21f4ce8a-7505-4b7f-8c98-c9cc8f62cba8"],
Cell[CellGroupData[{
Cell[53549, 1412, 2920, 84, 264, "Input", "ExpressionUUID" -> \
"ee406a65-7451-426c-9309-2ff1106a3688"],
Cell[56472, 1498, 6207, 145, 156, "Output", "ExpressionUUID" -> \
"2c56b142-1640-44ae-8897-5e5bc8fde2e9"],
Cell[62682, 1645, 157, 3, 32, "Output", "ExpressionUUID" -> \
"185190cb-3843-46aa-b400-edf845af02c2"],
Cell[62842, 1650, 157, 3, 32, "Output", "ExpressionUUID" -> \
"20be4f42-9c2a-4b66-bc94-106cee6637dc"],
Cell[63002, 1655, 1376, 38, 242, "Output", "ExpressionUUID" -> \
"dcad0950-957c-4e41-a0c7-11cfc7aa8007"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64415, 1698, 407, 11, 75, "Input", "ExpressionUUID" -> \
"35f2da2a-dda2-4b71-8ee4-a37ff727fdf3"],
Cell[64825, 1711, 32209, 760, 1106, "Output", "ExpressionUUID" -> \
"81a006db-0b80-4514-bb3a-49ffae2da0f2"]
}, Open  ]]
}, Open  ]]
}
]
*)

